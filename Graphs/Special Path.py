import heapq
def solve(A, B, C, D):
    n = len(B)
    temp = {}
    m = len(A)
    dist = {}
    for i in range(1, m + 1):
        dist[i] = 9999999
    for i in range(n):
        try:
            temp[B[i][0]][B[i][1]] = B[i][2]
        except:
            temp[B[i][0]] = {}
            temp[B[i][0]][B[i][1]] = B[i][2]
        try:
            temp[B[i][1]][B[i][0]] = B[i][2]
        except:
            temp[B[i][1]] = {}
            temp[B[i][1]][B[i][0]] = B[i][2]
    q = []
    dist[1] = 0
    if A[0] == 0:
        countn = 1
    else:
        countn = 0
    if A[0] == 1:
        counts = 1
    else:
        counts = 0
    q.append((0, 1, countn, counts))
    flag = False
    while q:
        cost, node, x, y = heapq.heappop(q)
        if node == m:
            if x >= C and y >= D:
                flag = True
                print(cost)
                return
        if node not in temp:
            continue
        for neighbour in temp[node]:
            type = A[neighbour - 1]
            if type == 0:
                heapq.heappush(q, (cost + temp[node][neighbour], neighbour, x + 1, y))
            else:
                heapq.heappush(q, (cost + temp[node][neighbour], neighbour, x, y + 1))
    print(-1)
A= [ 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0 ]
B=[
  [1, 2, 76837],
  [2, 3, 61925],
  [3, 4, 76920],
  [1, 5, 68354],
  [2, 6, 85594],
  [1, 7, 60905],
  [6, 8, 68346],
  [2, 9, 83465],
  [3, 10, 66663],
  [6, 11, 82999],
  [3, 12, 69657],
  [6, 13, 78930],
  [13, 14, 79634],
  [13, 15, 73111],
  [2, 16, 88771],
  [1, 17, 87250],
  [4, 18, 76203],
  [11, 19, 70076],
  [12, 20, 57884],
  [2, 21, 63177],
  [13, 22, 57368],
  [5, 23, 85038],
  [18, 24, 72359],
  [23, 25, 68796],
  [9, 26, 58940],
  [21, 27, 68967],
  [16, 28, 86350],
  [20, 29, 58553],
  [1, 30, 64321],
  [26, 31, 64825],
  [21, 32, 66741],
  [4, 33, 84108],
  [31, 34, 62470],
  [4, 35, 65120],
  [33, 36, 79790],
  [16, 37, 67712],
  [25, 38, 77422],
  [9, 39, 76099],
  [29, 40, 58787],
  [16, 41, 62294],
  [24, 42, 59514],
  [20, 43, 84886],
  [42, 44, 59745],
  [40, 45, 70936],
  [11, 46, 65743],
  [31, 47, 82649],
  [15, 48, 88035],
  [20, 49, 59522],
  [40, 50, 73822],
  [23, 51, 55897],
  [14, 52, 64396],
  [28, 53, 75357],
  [29, 54, 74177],
  [17, 55, 66562],
  [55, 56, 75000],
  [19, 57, 54226],
  [50, 58, 67618],
  [46, 59, 69148],
  [34, 60, 87338],
  [4, 61, 92918],
  [51, 62, 90606],
  [7, 63, 80848],
  [55, 64, 85587],
  [44, 65, 73010],
  [64, 66, 83045],
  [27, 67, 69460],
  [8, 68, 66362],
  [38, 69, 89958],
  [20, 70, 54583],
  [34, 71, 74356],
  [62, 72, 81367],
  [40, 73, 68624],
  [40, 74, 59326],
  [19, 75, 56401],
  [44, 76, 74889],
  [17, 77, 74284],
  [29, 78, 53876],
  [38, 79, 67709],
  [74, 80, 83005],
  [38, 81, 60075],
  [30, 82, 77263],
  [3, 83, 60550],
  [69, 84, 61117],
  [52, 85, 77513],
  [69, 86, 71001],
  [62, 87, 79558],
  [63, 88, 82325],
  [73, 89, 74431],
  [78, 90, 62547],
  [5, 91, 82280],
  [55, 92, 54995],
  [87, 93, 78310],
  [1, 94, 64234],
  [85, 95, 76170],
  [24, 96, 63856],
  [38, 97, 88636],
  [27, 98, 84634],
  [85, 99, 56859],
  [81, 100, 58695],
  [11, 101, 83040],
  [59, 102, 76287],
  [26, 103, 88230],
  [34, 104, 82448],
  [93, 105, 83811],
  [74, 106, 61756],
  [71, 107, 66534],
  [39, 108, 55658],
  [83, 109, 91226],
  [91, 110, 57551],
  [46, 111, 57385],
  [103, 112, 55423],
  [109, 113, 69834],
  [90, 114, 58452],
  [104, 115, 79298],
  [51, 116, 70963],
  [23, 117, 63708],
  [15, 118, 60937],
  [53, 119, 54389],
  [38, 120, 64844],
  [3, 121, 77147],
  [91, 122, 60496],
  [56, 123, 78203],
  [51, 124, 85110],
  [79, 125, 56674],
  [111, 126, 68146],
  [59, 127, 71267],
  [11, 128, 69942],
  [106, 129, 83029],
  [38, 130, 68046],
  [61, 131, 68697],
  [109, 132, 75821],
  [9, 133, 60441],
  [98, 134, 92283],
  [69, 135, 87771],
  [46, 136, 59726],
  [121, 137, 71974],
  [26, 138, 59416],
  [57, 139, 65707],
  [120, 140, 78421],
  [49, 141, 69288],
  [67, 142, 68327],
  [137, 143, 74341],
  [98, 144, 57295],
  [92, 145, 57229],
  [39, 146, 75116],
  [129, 147, 82407],
  [53, 148, 88809],
  [86, 149, 76310],
  [138, 150, 80384],
  [45, 151, 85259],
  [122, 152, 74143],
  [47, 153, 85112],
  [131, 154, 57965],
  [128, 155, 56490],
  [137, 156, 83297],
  [136, 157, 59150],
  [67, 158, 85281],
  [123, 159, 69385],
  [140, 160, 56699],
  [145, 161, 78502],
  [66, 162, 74626],
  [120, 163, 74391],
  [109, 164, 58729],
  [13, 165, 73145],
  [43, 166, 71246],
  [48, 167, 85264],
  [52, 168, 68673],
  [35, 169, 54999],
  [60, 170, 77693],
  [28, 171, 72912],
  [47, 172, 71248],
  [96, 173, 59028],
  [137, 174, 62222],
  [57, 175, 82132],
  [143, 176, 73401],
  [88, 177, 88993],
  [30, 178, 61680],
  [69, 179, 77639],
  [18, 180, 67297],
  [83, 181, 74920],
  [163, 182, 76903],
  [70, 183, 75838],
  [121, 184, 71270],
  [118, 185, 81864],
  [71, 186, 63952],
  [115, 187, 82249],
  [74, 188, 87580],
  [53, 189, 82413],
  [78, 190, 75276],
  [165, 191, 65998],
  [113, 192, 76983],
  [67, 193, 59867],
  [46, 194, 67682],
  [18, 195, 57553],
  [25, 196, 66986],
  [137, 197, 61332],
  [192, 198, 65961],
  [196, 199, 63259],
  [122, 200, 78952],
  [176, 201, 67276],
  [130, 202, 79468],
  [73, 203, 68301],
  [145, 204, 82474],
  [192, 205, 70474],
  [87, 206, 68292],
  [104, 207, 62887],
  [156, 208, 74673],
  [192, 209, 60246],
  [134, 210, 68104],
  [110, 211, 72758],
  [169, 212, 74609],
  [206, 213, 78602],
  [126, 214, 79126],
  [74, 215, 72023],
  [164, 216, 87540],
  [177, 217, 82371],
  [180, 218, 70228],
  [88, 219, 59783],
  [32, 220, 92409],
  [132, 221, 70103],
  [161, 222, 63302],
  [167, 223, 59619],
  [201, 224, 66420],
  [12, 225, 89971],
  [19, 226, 93290],
  [137, 227, 54830],
  [181, 228, 58814],
  [74, 229, 66524],
  [79, 230, 65371],
  [205, 231, 87078],
  [204, 232, 85225],
  [182, 233, 57389],
  [109, 234, 77628],
  [53, 235, 83364],
  [178, 236, 72936],
  [232, 237, 55878],
  [101, 238, 57827],
  [70, 239, 86233],
  [211, 240, 55353],
  [104, 241, 82992],
  [8, 242, 81847],
  [44, 243, 78565],
  [135, 244, 68121],
  [175, 245, 79723],
  [127, 246, 59612],
  [243, 247, 60252],
  [102, 248, 63734],
  [177, 249, 79637],
  [155, 250, 81058],
  [63, 251, 83932],
  [9, 252, 71971],
  [98, 253, 61130],
  [65, 254, 66764],
  [80, 255, 87954],
  [27, 256, 60631],
  [196, 257, 80322],
  [186, 258, 77256],
  [12, 259, 85638],
  [84, 260, 76546],
  [236, 261, 94434],
  [217, 262, 69225],
  [229, 263, 65969],
  [29, 264, 89927],
  [51, 265, 87762],
  [228, 266, 72554],
  [22, 267, 76291],
  [266, 268, 65969],
  [27, 269, 61070],
  [7, 270, 69345],
  [219, 271, 85995],
  [94, 272, 65752],
  [245, 273, 72622],
  [148, 274, 79566],
  [214, 275, 67018],
  [59, 276, 83244],
  [139, 277, 67615],
  [104, 278, 79761],
  [267, 279, 72229],
  [5, 280, 76435],
  [270, 281, 66667],
  [238, 282, 92944],
  [30, 283, 79269],
  [283, 284, 61252],
  [31, 285, 77166],
  [18, 286, 76369],
  [186, 287, 79250],
  [32, 288, 78010],
  [11, 289, 56269],
  [162, 290, 78158],
  [183, 291, 83590],
  [196, 292, 73673],
  [153, 293, 85245],
  [188, 294, 82002],
  [103, 295, 60520],
  [123, 296, 70488],
  [266, 297, 77245],
  [201, 298, 64632],
  [36, 299, 63038],
  [136, 300, 87946],
  [46, 301, 88305],
  [254, 302, 77170],
  [286, 303, 77068],
  [93, 304, 89307],
  [299, 305, 63098],
  [40, 306, 81487],
  [59, 307, 81688],
  [54, 308, 72623],
  [92, 309, 72148],
  [257, 310, 87134],
  [231, 311, 58585],
  [95, 312, 66423],
  [134, 313, 77001],
  [27, 314, 77387],
  [155, 315, 70366],
  [75, 316, 74973],
  [297, 317, 66587],
  [58, 318, 93986],
  [294, 319, 66481],
  [38, 320, 93377],
  [147, 321, 85391],
  [239, 322, 87340],
  [61, 323, 60334],
  [239, 324, 61455],
  [240, 325, 77439],
  [235, 326, 67646],
  [186, 327, 86049],
  [237, 328, 74609],
  [234, 329, 57192],
  [184, 330, 66745],
  [57, 331, 67329],
  [211, 332, 76398],
  [35, 333, 72608],
  [132, 334, 74554],
  [288, 335, 68276],
  [315, 336, 82756],
  [112, 337, 60350],
  [191, 338, 79805],
  [86, 339, 77301],
  [209, 340, 76400],
  [20, 341, 62383],
  [295, 342, 72862],
  [93, 343, 55757],
  [233, 344, 85283],
  [68, 345, 92838],
  [306, 346, 55884],
  [303, 347, 77062],
  [311, 348, 95085],
  [223, 349, 79105],
  [109, 350, 62018],
  [41, 351, 85659],
  [188, 352, 67354],
  [151, 353, 66698],
  [194, 354, 85341],
  [167, 355, 65016],
  [118, 356, 61957],
  [190, 357, 76732],
  [138, 358, 83675],
  [147, 359, 69039],
  [247, 360, 71952],
  [67, 361, 65027],
  [288, 362, 87047],
  [228, 363, 72350],
  [207, 364, 82698],
  [83, 365, 69270],
  [283, 366, 73321],
  [275, 367, 74517],
  [223, 368, 68379],
  [114, 369, 78074],
  [349, 370, 58942],
  [282, 371, 89658],
  [237, 372, 67490],
  [340, 373, 93190],
  [208, 374, 62543],
  [31, 375, 67412],
  [286, 376, 86295],
  [48, 377, 69682],
  [119, 378, 81009],
  [335, 379, 81697],
  [355, 380, 83272],
  [162, 381, 92820],
  [97, 382, 66442],
  [278, 383, 66726],
  [252, 384, 55836],
  [99, 385, 58303],
  [196, 386, 55738],
  [311, 387, 92055],
  [62, 388, 73938],
  [237, 389, 59109],
  [231, 390, 81530],
  [290, 391, 77843],
  [120, 392, 64952],
  [134, 393, 69602],
  [295, 394, 60383],
  [211, 395, 86291],
  [257, 396, 59913],
  [228, 397, 63316],
  [93, 398, 61993],
  [245, 399, 87380],
  [47, 400, 70144],
  [280, 401, 72197],
  [21, 402, 76626],
  [367, 403, 60986],
  [365, 404, 53268],
  [229, 405, 78901],
  [380, 406, 81770],
  [14, 407, 75254],
  [403, 408, 68006],
  [382, 409, 70806],
  [97, 410, 80689],
  [23, 411, 76076],
  [180, 412, 82291],
  [150, 413, 59144],
  [245, 414, 91893],
  [147, 415, 65958],
  [203, 416, 69445],
  [216, 417, 62252],
  [70, 418, 64874],
  [379, 419, 59524],
  [259, 420, 63391],
  [251, 421, 75554],
  [157, 422, 60961],
  [145, 423, 87247],
  [26, 424, 76306],
  [363, 425, 72535],
  [208, 426, 57408],
  [289, 427, 70376],
  [325, 428, 76648],
  [378, 429, 88073],
  [28, 430, 61856],
  [375, 431, 81228],
  [395, 432, 90061],
  [166, 433, 68916],
  [137, 434, 67282],
  [29, 435, 84853],
  [53, 436, 72180],
  [369, 437, 58847],
  [333, 438, 88909],
  [38, 439, 72148],
  [102, 440, 64768],
  [169, 441, 76713],
  [281, 442, 54595],
  [63, 443, 59905],
  [88, 444, 78826],
  [276, 445, 70019],
  [83, 446, 85508],
  [223, 447, 66335],
  [264, 448, 65769],
  [89, 449, 83624],
  [301, 450, 68290],
  [314, 451, 77377],
  [288, 452, 64880],
  [306, 453, 74013],
  [407, 454, 76448],
  [422, 455, 76768],
  [12, 22, 67912],
  [270, 229, 58217],
  [141, 31, 73770],
  [396, 80, 57793],
  [53, 331, 73470],
  [333, 406, 84994],
  [387, 327, 64467],
  [225, 168, 67918],
  [45, 98, 89600],
  [421, 310, 69425],
  [237, 87, 88637],
  [26, 279, 78489],
  [59, 308, 86336],
  [304, 142, 78433],
  [97, 448, 64287],
  [220, 279, 72566],
  [21, 153, 84595],
  [159, 229, 60140],
  [5, 442, 64361],
  [369, 283, 68157],
  [332, 101, 75096],
  [434, 126, 69085]
]
C =  7
D = 2
solve(A,B,C,D)

